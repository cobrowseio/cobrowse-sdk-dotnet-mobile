# User-generated codes (optional)

Please see full documentation at [https://cobrowse.io/docs](https://cobrowse.io/docs).

Try our **online demo** at the bottom of our homepage at <https://cobrowse.io/#tryit>.

## Implementation

These are the native-side requirements on iOS and Android to initiate sessions using 6-digit codes. More info at <https://cobrowse.io/docs#user-generated-codes>

You may expose a small UI in your app for users to generate a 6-digit code that they pass to an agent over the phone or chat to initiate a session.

### Xamarin.iOS implementation

To setup user-initiated sessions:

1. Add the appropriate code below into a view controller in your app.
2. Hook up a trigger for the action (or call it programatically if you prefer).

```cs
using Xamarin.CobrowseIO;

namespace SampleApp.iOS
{
    public partial class ViewController : UIViewController
    {
        private void StartCobrowse(object sender, EventArgs e)
        {
            NavigationController.PushViewController(new CBIOViewController(), animated: true);
        }
    }
}
```

For a full example written in C#, see our sample app at: <https://github.com/cobrowseio/cobrowse-sdk-xamarin>

### Xamarin.Android implementation

We have provided some default UI to make things easier to get started:

```cs
using Xamarin.CobrowseIO;
using Xamarin.CobrowseIO.UI;

namespace SampleApp.Android
{
    [Activity]
    public class MainActivity : AppCompatActivity
    {
        private void StartCobrowse(object sender, EventArgs e)
        {
            var intent = new Intent(this, typeof(CobrowseActivity));
            StartActivity(intent);
        }
    }
}
```

### Xamarin.Forms implementation

While it is not possible to access platform-specific code directly from a cross-platform project, you can easily achieve it using [DependencyService](https://docs.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/dependency-service/introduction).

In your **cross-platform** project declare an interface for accessing Cobrowse.io SDK:

```cs
using System;

namespace YourAppNamespace.Forms
{
    public interface ICobrowseAdapter
    {
        void StartCobrowse();
    }
}
```

**iOS-specific** implementation would look like this:

```cs
using System.Linq;
using UIKit;
using Xamarin.CobrowseIO;

[assembly: Xamarin.Forms.Dependency(typeof(YourAppNamespace.iOS.CobrowseAdapter))]
namespace YourAppNamespace.iOS
{
    public class CobrowseAdapter : ICobrowseAdapter
    {
        public void StartCobrowse()
        {
            var vc = UIApplication.SharedApplication.KeyWindow.RootViewController;
            var nc = vc.GetUINavigationController();
            nc.PushViewController(
                new CBIOViewController(),
                animated: true);
        }
    }

    public static class UIViewControllerExtensions
    {
        public static UINavigationController GetUINavigationController(this UIViewController controller)
        {
            if (controller != null)
            {
                if (controller is UINavigationController nv)
                {
                    return nv;
                }
                else if (controller.ChildViewControllers.Any())
                {
                    int count = controller.ChildViewControllers.Count();
                    for (int i = 0; i < count; i++)
                    {
                        var child = GetUINavigationController(controller.ChildViewControllers[i]);
                        if (child is UINavigationController nc)
                        {
                            return nc;
                        }
                    }
                }
            }
            return null;
        }
    }
}

```

**Android-speific** implementation would look like this (it uses [CurrentActivityPlugin](https://github.com/jamesmontemagno/CurrentActivityPlugin)):

```cs
using Android.App;
using Android.Content;
using Plugin.CurrentActivity;
using Xamarin.CobrowseIO.UI;

[assembly: Xamarin.Forms.Dependency(typeof(YourAppNamespace.Android.CobrowseAdapter))]
namespace YourAppNamespace.Android
{
    public class CobrowseAdapter : ICobrowseAdapter
    {
        private Activity Activity => CrossCurrentActivity.Current.Activity;

        public void StartCobrowse()
        {
            var intent = new Intent(Activity, typeof(CobrowseActivity));
            Activity.StartActivity(intent);
        }
    }
}
```

## Test it

Make sure you've hooked up a trigger for the `StartCobrowse` method that we've just added. Then head to <https://cobrowse.io/dashboard> and enter the 6 digit code that will be generated by your app when you trigger the action!

## Questions?
Any questions at all? Please email us directly at [hello@cobrowse.io](mailto:hello@cobrowse.io).
